#include "filterdtmf.h"


static double filter_h697_taps[993] = {
  -0.005086955056450218,
  0.0006312254099021795,
  0.0006020327760011403,
  0.0005798321201427584,
  0.0005637517384386612,
  0.0005529483829888035,
  0.0005466280934388466,
  0.0005439945964885792,
  0.0005442635529990322,
  0.0005466941651550448,
  0.0005505730614948651,
  0.0005552124369669894,
  0.0005599583235580686,
  0.0005642065590914267,
  0.000567343347674093,
  0.0005688633534317696,
  0.0005682709697341287,
  0.0005651169975822969,
  0.0005590491426916567,
  0.0005496908258124033,
  0.0005367902590058481,
  0.0005201193733640575,
  0.0004995260749684264,
  0.0004749196672411569,
  0.00044628011637230336,
  0.00041364442963771127,
  0.0003771201315299202,
  0.0003368653068857251,
  0.00029312424482382004,
  0.00024607390013131446,
  0.00019632289296589849,
  0.00014379735685561988,
  0.00008949414009551973,
  0.000033482144753409484,
  -0.000023673459108175974,
  -0.00008122767816035207,
  -0.0001387523809809083,
  -0.00019573871475200974,
  -0.0002514830438032994,
  -0.0003053284360407722,
  -0.00035673464215573363,
  -0.00040516981800933923,
  -0.00045005374692544376,
  -0.0004907869195241672,
  -0.0005268042633806899,
  -0.0005577114408459393,
  -0.0005831158148307024,
  -0.0006026165643466962,
  -0.0006159233372109619,
  -0.0006226919126269053,
  -0.0006227904246614653,
  -0.0006161035903010204,
  -0.0006026160856338064,
  -0.0005823472753008564,
  -0.0005553764469046408,
  -0.0005218564499145843,
  -0.00048205630941953987,
  -0.0004363346095477598,
  -0.00038512509329585254,
  -0.0003288531259009355,
  -0.00026809891478454296,
  -0.00020332059787090653,
  -0.00013529271530282892,
  -0.00006460786947417857,
  0.000007995174979282717,
  0.00008170762913014886,
  0.00015578838891141733,
  0.00022941353139776014,
  0.00030178084324973287,
  0.0003721373281842307,
  0.0004396872038911861,
  0.000503642230163204,
  0.0005633052525661796,
  0.0006179799716076128,
  0.0006669590527552535,
  0.0007096960942493245,
  0.0007456306329685999,
  0.0007742362735724041,
  0.0007952722174890377,
  0.0008082739789012627,
  0.0008131236295123244,
  0.0008096206974694657,
  0.0007977255380027988,
  0.0007774428168766008,
  0.0007488773116101963,
  0.0007122420240338893,
  0.0006678765243087493,
  0.0006161977767222742,
  0.0005576800878596885,
  0.0004928242417404533,
  0.0004222469411142362,
  0.0003465721528282515,
  0.0002666347971132904,
  0.00018323247491600094,
  0.00009721811492267326,
  0.000009446729560370672,
  -0.00007927250218853163,
  -0.00016799371773847482,
  -0.00025572293947336645,
  -0.00034151382884687557,
  -0.00042453307922652264,
  -0.0005040090721762186,
  -0.0005790737126466565,
  -0.0006487607950193125,
  -0.0007123445582522716,
  -0.0007694114355919476,
  -0.0008191793989693766,
  -0.0008607775483116436,
  -0.0008944773075467514,
  -0.0009191448961694984,
  -0.0009349914531201384,
  -0.0009415930335278954,
  -0.0009389179504560225,
  -0.0009269567312821507,
  -0.0009058031683050216,
  -0.0008756343527655272,
  -0.0008367288210635045,
  -0.0007894506207829382,
  -0.0007342543422220809,
  -0.0006716723189309395,
  -0.000602333320150024,
  -0.0005268840692361851,
  -0.0004461024819142046,
  -0.0003607546220937828,
  -0.0002716747361527184,
  -0.00017975835288737944,
  -0.00008587652319409493,
  0.000009021212392447028,
  0.00010401600299064804,
  0.0001981896327157206,
  0.00029063329363179097,
  0.00038045844681529643,
  0.00046681208372033507,
  0.0005488628860019654,
  0.0006258269207245053,
  0.0006970185624399466,
  0.0007622072244397217,
  0.0008155408296250926,
  0.0008761082495995934,
  0.0009103534229557735,
  0.0009416721251801652,
  0.0009681963790379621,
  0.0009865165778642363,
  0.0009948677928775006,
  0.0009929253498865967,
  0.000981156714318707,
  0.0009602917193048914,
  0.0009309971889367857,
  0.0008937892503065678,
  0.0008490672952893587,
  0.0007971780074876092,
  0.0007384442239439693,
  0.0006733113047895579,
  0.0006022497587192475,
  0.0005258359178354853,
  0.00044476903016847495,
  0.0003597499322696148,
  0.0002716189348846714,
  0.0001811862541463365,
  0.00008929494341551345,
  -0.000003224374737971063,
  -0.00009555040157029834,
  -0.00018689182913160467,
  -0.0002764775348353801,
  -0.0003635768900432767,
  -0.0004474779609425398,
  -0.0005275714841628306,
  -0.0006030816459027706,
  -0.0006737601019933603,
  -0.0007386524031754141,
  -0.0007976872961846552,
  -0.0008502612946498044,
  -0.0008959049510354908,
  -0.0009344743935727815,
  -0.0009656727693356224,
  -0.000989193309114554,
  -0.0010049305639337612,
  -0.0010128554090279393,
  -0.0010129039731536912,
  -0.001005042894765909,
  -0.0009893317737026963,
  -0.0009659222683867435,
  -0.0009350734220864005,
  -0.0008969653209399164,
  -0.0008518187741733856,
  -0.0008000028861539134,
  -0.0007418351314681129,
  -0.0006778173273883485,
  -0.0006083484147914713,
  -0.0005338915508688002,
  -0.0004549159296772255,
  -0.00037194912645293005,
  -0.0002855589971920281,
  -0.00019634662136601771,
  -0.00010489790566759786,
  -0.000011799878870590092,
  0.00008236598949440444,
  0.00017690094583206855,
  0.0002712231114616851,
  0.0003645500307684158,
  0.000456357367198767,
  0.000545971842435765,
  0.0006327288947743826,
  0.0007160442254972949,
  0.0007952596876031634,
  0.0008697665304335139,
  0.0009389677402849301,
  0.001002234047310781,
  0.0010590074220626232,
  0.0011088060976883938,
  0.0011511054166695753,
  0.0011854152272881618,
  0.0012113936066374341,
  0.0012286055358759949,
  0.0012366737112925726,
  0.0012354428738225627,
  0.0012244711048553577,
  0.001203748929611975,
  0.0011730791414825718,
  0.0011324748177293116,
  0.0010819651945810948,
  0.0010216751962540073,
  0.0009517954192101618,
  0.0008725854829030119,
  0.000784356349579483,
  0.0006875143530808456,
  0.0005825755960378716,
  0.0004702073134252876,
  0.00035109302926660863,
  0.00022606359464340367,
  0.00009587275717528781,
  -0.000038595760517398256,
  -0.0001763528994614627,
  -0.00031632408089618064,
  -0.0004572759240204352,
  -0.000598026372501451,
  -0.0007374505030553204,
  -0.0008743854333598709,
  -0.0010075144516077674,
  -0.0011353841356763331,
  -0.0012566396147675445,
  -0.0013702301458126589,
  -0.0014750567822112428,
  -0.0015694643038243188,
  -0.0016521594345668925,
  -0.001722943315085797,
  -0.001779537527046921,
  -0.0018219457120943053,
  -0.0018488337370356075,
  -0.0018596315344836666,
  -0.0018537026024437746,
  -0.0018305773151869795,
  -0.0017899334669281644,
  -0.0017316204486933207,
  -0.0016556443009328903,
  -0.0015621839968071214,
  -0.0014515929988724323,
  -0.0013244160030835225,
  -0.001181344534303386,
  -0.0010233180446309429,
  -0.0008513846475530192,
  -0.0006668115230128945,
  -0.00047103800663172296,
  -0.0002656101733727196,
  -0.000052283609643404275,
  0.00016710439951052967,
  0.00039057198858631853,
  0.0006160285998407736,
  0.000841300518530572,
  0.001064157648508108,
  0.001282318044654435,
  0.0014934896045222558,
  0.0016953938533957997,
  0.0018858525710068476,
  0.0020617637451634816,
  0.0022244244931041014,
  0.002364514288511267,
  0.0024883756638629604,
  0.002590738363540056,
  0.002668627147407016,
  0.002721434370747873,
  0.002748856949341123,
  0.0027501586872070213,
  0.0027243651693646936,
  0.002670680278088072,
  0.0025887865234027465,
  0.0024788913638378015,
  0.0023416084274472844,
  0.0021778199848027915,
  0.001988675332648232,
  0.0017754575888087169,
  0.0015397181302601337,
  0.0012832926535379936,
  0.0010082352880787654,
  0.0007169714909629315,
  0.0004121078886665793,
  0.00009652915792125795,
  -0.00022669781920592818,
  -0.0005543514904292325,
  -0.0008831155680919166,
  -0.0012096000650907888,
  -0.001530387434398259,
  -0.0018420424201421402,
  -0.0021411864681382792,
  -0.0024243809826335508,
  -0.0026885657658826737,
  -0.0029302706390208705,
  -0.003146860161227396,
  -0.0033353216596966554,
  -0.0034931292032769775,
  -0.003618152858995696,
  -0.0037083189527853224,
  -0.00376195452797994,
  -0.0037778605484883937,
  -0.0037551391191018696,
  -0.003693235342153635,
  -0.0035920641155181344,
  -0.0034519905085284275,
  -0.0032737828308956225,
  -0.003058626419405806,
  -0.002808027872765303,
  -0.002523995245372572,
  -0.0022090052557425226,
  -0.0018657635379739994,
  -0.001497451122413441,
  -0.0011074145110987579,
  -0.0006994049834079386,
  -0.0002774191235781566,
  0.00015430724148088025,
  0.0005913876757170644,
  0.0010293174977286173,
  0.0014635217092935139,
  0.0018893562605546259,
  0.002302171901869772,
  0.002697331506973648,
  0.003070442386283166,
  0.0034171335692939394,
  0.003733445273082214,
  0.0040154676389089336,
  0.004259661699223598,
  0.00446291527096325,
  0.004622440146482911,
  0.00473592688888511,
  0.004801498546056001,
  0.004817745556474689,
  0.004783819426014057,
  0.004699370878775424,
  0.004564506914246665,
  0.004379953756442858,
  0.004147058393142551,
  0.003867546944292254,
  0.003543777938394223,
  0.0031787387263717526,
  0.00277554848827677,
  0.0023382259871367788,
  0.0018708146699121131,
  0.001377952428058695,
  0.000864513662343483,
  0.0003357033296416237,
  -0.0002030407579556259,
  -0.0007460894638316708,
  -0.0012876986468128944,
  -0.0018220561303880153,
  -0.0023433770916275855,
  -0.0028459637992993697,
  -0.003324328110635,
  -0.003773083500413811,
  -0.00418715799253819,
  -0.004561656754367263,
  -0.0048920751994488984,
  -0.005174413653068525,
  -0.005405164711433695,
  -0.005581443911352841,
  -0.005700841476630317,
  -0.00576138536142578,
  -0.005761657439562376,
  -0.005701010072108062,
  -0.0055796800065406335,
  -0.0053985799322680775,
  -0.005158842882514638,
  -0.00486195170854477,
  -0.004510926155615811,
  -0.004109903984085284,
  -0.0036607572899444245,
  -0.0031696669627534904,
  -0.0026404244833475397,
  -0.0020787338260867465,
  -0.0014902208402660458,
  -0.0008809441449694405,
  -0.0002572371208105113,
  0.000374352237835562,
  0.001007150306062359,
  0.0016344080343021208,
  0.002249376718407143,
  0.002845380394258206,
  0.003415916328486671,
  0.003954654114182259,
  0.004455629003834064,
  0.004913179634535788,
  0.005322086193827308,
  0.005677649432569066,
  0.005975644403730523,
  0.0062124993687097405,
  0.006385240651584293,
  0.0064915796040850475,
  0.006529936192713882,
  0.006499456004986915,
  0.006400008331625281,
  0.006232213787028764,
  0.005997434141624615,
  0.005697781684495062,
  0.00533581340560676,
  0.004916080578400645,
  0.004440212944779535,
  0.003916676660823088,
  0.0033479373874646706,
  0.002740126277151683,
  0.002100531828310432,
  0.001435792723976621,
  0.0007524083087821276,
  0.000057377545430377306,
  -0.0006417841452771917,
  -0.001337369399443971,
  -0.0020218096660304646,
  -0.00268781213815297,
  -0.0033283212830535016,
  -0.003936434676057397,
  -0.004505538474018526,
  -0.0050292868866304765,
  -0.00550179774909427,
  -0.005917814127928452,
  -0.006272629075977084,
  -0.006562301485671305,
  -0.006783511559690322,
  -0.006933679489228474,
  -0.007010958118622883,
  -0.007014270961698571,
  -0.006943312867329479,
  -0.006798584203676041,
  -0.006581386826654154,
  -0.0062938471262873105,
  -0.005938811208855475,
  -0.005520040468631478,
  -0.00504163988860443,
  -0.004508882881374034,
  -0.00392710515857074,
  -0.003302496322645178,
  -0.0026416935764042976,
  -0.001951548625771629,
  -0.0012394079857476856,
  -0.0005129041052969342,
  0.00022026469144268148,
  0.0009522903020447623,
  0.0016752993574808083,
  0.00238153632477489,
  0.0030634430016821253,
  0.0037136921815199586,
  0.004325330455661232,
  0.00489171237680381,
  0.005406704915480275,
  0.005864874687138618,
  0.006261220594302979,
  0.006591547309010738,
  0.00685221787719199,
  0.007040425351911432,
  0.007154148015086601,
  0.0071921897868096486,
  0.007154148015086601,
  0.007040425351911432,
  0.00685221787719199,
  0.006591547309010738,
  0.006261220594302979,
  0.005864874687138618,
  0.005406704915480275,
  0.00489171237680381,
  0.004325330455661232,
  0.0037136921815199586,
  0.0030634430016821253,
  0.00238153632477489,
  0.0016752993574808083,
  0.0009522903020447623,
  0.00022026469144268148,
  -0.0005129041052969342,
  -0.0012394079857476856,
  -0.001951548625771629,
  -0.0026416935764042976,
  -0.003302496322645178,
  -0.00392710515857074,
  -0.004508882881374034,
  -0.00504163988860443,
  -0.005520040468631478,
  -0.005938811208855475,
  -0.0062938471262873105,
  -0.006581386826654154,
  -0.006798584203676041,
  -0.006943312867329479,
  -0.007014270961698571,
  -0.007010958118622883,
  -0.006933679489228474,
  -0.006783511559690322,
  -0.006562301485671305,
  -0.006272629075977084,
  -0.005917814127928452,
  -0.00550179774909427,
  -0.0050292868866304765,
  -0.004505538474018526,
  -0.003936434676057397,
  -0.0033283212830535016,
  -0.00268781213815297,
  -0.0020218096660304646,
  -0.001337369399443971,
  -0.0006417841452771917,
  0.000057377545430377306,
  0.0007524083087821276,
  0.001435792723976621,
  0.002100531828310432,
  0.002740126277151683,
  0.0033479373874646706,
  0.003916676660823088,
  0.004440212944779535,
  0.004916080578400645,
  0.00533581340560676,
  0.005697781684495062,
  0.005997434141624615,
  0.006232213787028764,
  0.006400008331625281,
  0.006499456004986915,
  0.006529936192713882,
  0.0064915796040850475,
  0.006385240651584293,
  0.0062124993687097405,
  0.005975644403730523,
  0.005677649432569066,
  0.005322086193827308,
  0.004913179634535788,
  0.004455629003834064,
  0.003954654114182259,
  0.003415916328486671,
  0.002845380394258206,
  0.002249376718407143,
  0.0016344080343021208,
  0.001007150306062359,
  0.000374352237835562,
  -0.0002572371208105113,
  -0.0008809441449694405,
  -0.0014902208402660458,
  -0.0020787338260867465,
  -0.0026404244833475397,
  -0.0031696669627534904,
  -0.0036607572899444245,
  -0.004109903984085284,
  -0.004510926155615811,
  -0.00486195170854477,
  -0.005158842882514638,
  -0.0053985799322680775,
  -0.0055796800065406335,
  -0.005701010072108062,
  -0.005761657439562376,
  -0.00576138536142578,
  -0.005700841476630317,
  -0.005581443911352841,
  -0.005405164711433695,
  -0.005174413653068525,
  -0.0048920751994488984,
  -0.004561656754367263,
  -0.00418715799253819,
  -0.003773083500413811,
  -0.003324328110635,
  -0.0028459637992993697,
  -0.0023433770916275855,
  -0.0018220561303880153,
  -0.0012876986468128944,
  -0.0007460894638316708,
  -0.0002030407579556259,
  0.0003357033296416237,
  0.000864513662343483,
  0.001377952428058695,
  0.0018708146699121131,
  0.0023382259871367788,
  0.00277554848827677,
  0.0031787387263717526,
  0.003543777938394223,
  0.003867546944292254,
  0.004147058393142551,
  0.004379953756442858,
  0.004564506914246665,
  0.004699370878775424,
  0.004783819426014057,
  0.004817745556474689,
  0.004801498546056001,
  0.00473592688888511,
  0.004622440146482911,
  0.00446291527096325,
  0.004259661699223598,
  0.0040154676389089336,
  0.003733445273082214,
  0.0034171335692939394,
  0.003070442386283166,
  0.002697331506973648,
  0.002302171901869772,
  0.0018893562605546259,
  0.0014635217092935139,
  0.0010293174977286173,
  0.0005913876757170644,
  0.00015430724148088025,
  -0.0002774191235781566,
  -0.0006994049834079386,
  -0.0011074145110987579,
  -0.001497451122413441,
  -0.0018657635379739994,
  -0.0022090052557425226,
  -0.002523995245372572,
  -0.002808027872765303,
  -0.003058626419405806,
  -0.0032737828308956225,
  -0.0034519905085284275,
  -0.0035920641155181344,
  -0.003693235342153635,
  -0.0037551391191018696,
  -0.0037778605484883937,
  -0.00376195452797994,
  -0.0037083189527853224,
  -0.003618152858995696,
  -0.0034931292032769775,
  -0.0033353216596966554,
  -0.003146860161227396,
  -0.0029302706390208705,
  -0.0026885657658826737,
  -0.0024243809826335508,
  -0.0021411864681382792,
  -0.0018420424201421402,
  -0.001530387434398259,
  -0.0012096000650907888,
  -0.0008831155680919166,
  -0.0005543514904292325,
  -0.00022669781920592818,
  0.00009652915792125795,
  0.0004121078886665793,
  0.0007169714909629315,
  0.0010082352880787654,
  0.0012832926535379936,
  0.0015397181302601337,
  0.0017754575888087169,
  0.001988675332648232,
  0.0021778199848027915,
  0.0023416084274472844,
  0.0024788913638378015,
  0.0025887865234027465,
  0.002670680278088072,
  0.0027243651693646936,
  0.0027501586872070213,
  0.002748856949341123,
  0.002721434370747873,
  0.002668627147407016,
  0.002590738363540056,
  0.0024883756638629604,
  0.002364514288511267,
  0.0022244244931041014,
  0.0020617637451634816,
  0.0018858525710068476,
  0.0016953938533957997,
  0.0014934896045222558,
  0.001282318044654435,
  0.001064157648508108,
  0.000841300518530572,
  0.0006160285998407736,
  0.00039057198858631853,
  0.00016710439951052967,
  -0.000052283609643404275,
  -0.0002656101733727196,
  -0.00047103800663172296,
  -0.0006668115230128945,
  -0.0008513846475530192,
  -0.0010233180446309429,
  -0.001181344534303386,
  -0.0013244160030835225,
  -0.0014515929988724323,
  -0.0015621839968071214,
  -0.0016556443009328903,
  -0.0017316204486933207,
  -0.0017899334669281644,
  -0.0018305773151869795,
  -0.0018537026024437746,
  -0.0018596315344836666,
  -0.0018488337370356075,
  -0.0018219457120943053,
  -0.001779537527046921,
  -0.001722943315085797,
  -0.0016521594345668925,
  -0.0015694643038243188,
  -0.0014750567822112428,
  -0.0013702301458126589,
  -0.0012566396147675445,
  -0.0011353841356763331,
  -0.0010075144516077674,
  -0.0008743854333598709,
  -0.0007374505030553204,
  -0.000598026372501451,
  -0.0004572759240204352,
  -0.00031632408089618064,
  -0.0001763528994614627,
  -0.000038595760517398256,
  0.00009587275717528781,
  0.00022606359464340367,
  0.00035109302926660863,
  0.0004702073134252876,
  0.0005825755960378716,
  0.0006875143530808456,
  0.000784356349579483,
  0.0008725854829030119,
  0.0009517954192101618,
  0.0010216751962540073,
  0.0010819651945810948,
  0.0011324748177293116,
  0.0011730791414825718,
  0.001203748929611975,
  0.0012244711048553577,
  0.0012354428738225627,
  0.0012366737112925726,
  0.0012286055358759949,
  0.0012113936066374341,
  0.0011854152272881618,
  0.0011511054166695753,
  0.0011088060976883938,
  0.0010590074220626232,
  0.001002234047310781,
  0.0009389677402849301,
  0.0008697665304335139,
  0.0007952596876031634,
  0.0007160442254972949,
  0.0006327288947743826,
  0.000545971842435765,
  0.000456357367198767,
  0.0003645500307684158,
  0.0002712231114616851,
  0.00017690094583206855,
  0.00008236598949440444,
  -0.000011799878870590092,
  -0.00010489790566759786,
  -0.00019634662136601771,
  -0.0002855589971920281,
  -0.00037194912645293005,
  -0.0004549159296772255,
  -0.0005338915508688002,
  -0.0006083484147914713,
  -0.0006778173273883485,
  -0.0007418351314681129,
  -0.0008000028861539134,
  -0.0008518187741733856,
  -0.0008969653209399164,
  -0.0009350734220864005,
  -0.0009659222683867435,
  -0.0009893317737026963,
  -0.001005042894765909,
  -0.0010129039731536912,
  -0.0010128554090279393,
  -0.0010049305639337612,
  -0.000989193309114554,
  -0.0009656727693356224,
  -0.0009344743935727815,
  -0.0008959049510354908,
  -0.0008502612946498044,
  -0.0007976872961846552,
  -0.0007386524031754141,
  -0.0006737601019933603,
  -0.0006030816459027706,
  -0.0005275714841628306,
  -0.0004474779609425398,
  -0.0003635768900432767,
  -0.0002764775348353801,
  -0.00018689182913160467,
  -0.00009555040157029834,
  -0.000003224374737971063,
  0.00008929494341551345,
  0.0001811862541463365,
  0.0002716189348846714,
  0.0003597499322696148,
  0.00044476903016847495,
  0.0005258359178354853,
  0.0006022497587192475,
  0.0006733113047895579,
  0.0007384442239439693,
  0.0007971780074876092,
  0.0008490672952893587,
  0.0008937892503065678,
  0.0009309971889367857,
  0.0009602917193048914,
  0.000981156714318707,
  0.0009929253498865967,
  0.0009948677928775006,
  0.0009865165778642363,
  0.0009681963790379621,
  0.0009416721251801652,
  0.0009103534229557735,
  0.0008761082495995934,
  0.0008155408296250926,
  0.0007622072244397217,
  0.0006970185624399466,
  0.0006258269207245053,
  0.0005488628860019654,
  0.00046681208372033507,
  0.00038045844681529643,
  0.00029063329363179097,
  0.0001981896327157206,
  0.00010401600299064804,
  0.000009021212392447028,
  -0.00008587652319409493,
  -0.00017975835288737944,
  -0.0002716747361527184,
  -0.0003607546220937828,
  -0.0004461024819142046,
  -0.0005268840692361851,
  -0.000602333320150024,
  -0.0006716723189309395,
  -0.0007342543422220809,
  -0.0007894506207829382,
  -0.0008367288210635045,
  -0.0008756343527655272,
  -0.0009058031683050216,
  -0.0009269567312821507,
  -0.0009389179504560225,
  -0.0009415930335278954,
  -0.0009349914531201384,
  -0.0009191448961694984,
  -0.0008944773075467514,
  -0.0008607775483116436,
  -0.0008191793989693766,
  -0.0007694114355919476,
  -0.0007123445582522716,
  -0.0006487607950193125,
  -0.0005790737126466565,
  -0.0005040090721762186,
  -0.00042453307922652264,
  -0.00034151382884687557,
  -0.00025572293947336645,
  -0.00016799371773847482,
  -0.00007927250218853163,
  0.000009446729560370672,
  0.00009721811492267326,
  0.00018323247491600094,
  0.0002666347971132904,
  0.0003465721528282515,
  0.0004222469411142362,
  0.0004928242417404533,
  0.0005576800878596885,
  0.0006161977767222742,
  0.0006678765243087493,
  0.0007122420240338893,
  0.0007488773116101963,
  0.0007774428168766008,
  0.0007977255380027988,
  0.0008096206974694657,
  0.0008131236295123244,
  0.0008082739789012627,
  0.0007952722174890377,
  0.0007742362735724041,
  0.0007456306329685999,
  0.0007096960942493245,
  0.0006669590527552535,
  0.0006179799716076128,
  0.0005633052525661796,
  0.000503642230163204,
  0.0004396872038911861,
  0.0003721373281842307,
  0.00030178084324973287,
  0.00022941353139776014,
  0.00015578838891141733,
  0.00008170762913014886,
  0.000007995174979282717,
  -0.00006460786947417857,
  -0.00013529271530282892,
  -0.00020332059787090653,
  -0.00026809891478454296,
  -0.0003288531259009355,
  -0.00038512509329585254,
  -0.0004363346095477598,
  -0.00048205630941953987,
  -0.0005218564499145843,
  -0.0005553764469046408,
  -0.0005823472753008564,
  -0.0006026160856338064,
  -0.0006161035903010204,
  -0.0006227904246614653,
  -0.0006226919126269053,
  -0.0006159233372109619,
  -0.0006026165643466962,
  -0.0005831158148307024,
  -0.0005577114408459393,
  -0.0005268042633806899,
  -0.0004907869195241672,
  -0.00045005374692544376,
  -0.00040516981800933923,
  -0.00035673464215573363,
  -0.0003053284360407722,
  -0.0002514830438032994,
  -0.00019573871475200974,
  -0.0001387523809809083,
  -0.00008122767816035207,
  -0.000023673459108175974,
  0.000033482144753409484,
  0.00008949414009551973,
  0.00014379735685561988,
  0.00019632289296589849,
  0.00024607390013131446,
  0.00029312424482382004,
  0.0003368653068857251,
  0.0003771201315299202,
  0.00041364442963771127,
  0.00044628011637230336,
  0.0004749196672411569,
  0.0004995260749684264,
  0.0005201193733640575,
  0.0005367902590058481,
  0.0005496908258124033,
  0.0005590491426916567,
  0.0005651169975822969,
  0.0005682709697341287,
  0.0005688633534317696,
  0.000567343347674093,
  0.0005642065590914267,
  0.0005599583235580686,
  0.0005552124369669894,
  0.0005505730614948651,
  0.0005466941651550448,
  0.0005442635529990322,
  0.0005439945964885792,
  0.0005466280934388466,
  0.0005529483829888035,
  0.0005637517384386612,
  0.0005798321201427584,
  0.0006020327760011403,
  0.0006312254099021795,
  -0.005086955056450218
};


static double filter_v1209_taps[515] = {
  0.0008740924269628361,
  0.004672801761569144,
  -0.00021272311555558523,
  0.0006946480927947145,
  0.0005117760839499976,
  0.0005092223845506028,
  0.00045227377881293173,
  0.00038493252171110254,
  0.0003004104788649088,
  0.00020198435931837415,
  0.00009186585059177863,
  -0.000026901205834418963,
  -0.000151080343689622,
  -0.0002767999466081219,
  -0.0004003403699552651,
  -0.0005177542698825884,
  -0.00062481242219283,
  -0.0007176456653055658,
  -0.0007926714911828006,
  -0.0008465893160811388,
  -0.0008768873413793753,
  -0.0008814070036755516,
  -0.000858749540635288,
  -0.0008082668969329513,
  -0.0007304135574717932,
  -0.0006265616058274011,
  -0.0004986787931562572,
  -0.00034972682601084075,
  -0.00018340624385128067,
  -0.000004115686638681422,
  0.0001828761748837526,
  0.00037215755851684206,
  0.000558094428062973,
  0.0007346064802047301,
  0.0008956934900890466,
  0.0010356927806390746,
  0.001149658881060617,
  0.0012328786690603748,
  0.001281387699582837,
  0.001292401281367153,
  0.0012641643594619694,
  0.0011960987249117257,
  0.001088768923401314,
  0.0009437227479152943,
  0.0007644547675825443,
  0.000554952198749455,
  0.00032092546341667847,
  0.00006810417062872957,
  -0.0001955380245200577,
  -0.0004629912661549661,
  -0.0007254473953967967,
  -0.0009754537736930192,
  -0.00120369669859372,
  -0.0014036238563394448,
  -0.0015671681564843496,
  -0.0016884851142644518,
  -0.0017622912562730408,
  -0.0017847221546431504,
  -0.001753739148983291,
  -0.0016677874249170822,
  -0.0015286552439903827,
  -0.0013383369016230506,
  -0.001100981470681533,
  -0.0008231550506163987,
  -0.0005111445694923044,
  -0.00017410200933348457,
  0.00017859635878946458,
  0.0005366385305129098,
  0.0008890395632583083,
  0.0012252700954412173,
  0.0015341012376924536,
  0.0018053723642900879,
  0.0020300873589149523,
  0.002199408762911539,
  0.002307082625368846,
  0.002348002976173003,
  0.002318489360973705,
  0.002218172134897853,
  0.002047952042401727,
  0.0018106655894585847,
  0.0015122120172941494,
  0.0011599062296731746,
  0.0007628421450610423,
  0.0003321497111754972,
  -0.00011984853913778586,
  -0.0005801381957648427,
  -0.0010350050321091527,
  -0.0014698955205060351,
  -0.001871474217074496,
  -0.0022269256508041096,
  -0.0025235232021256528,
  -0.00275119766533424,
  -0.0029016602769571277,
  -0.002967812669403306,
  -0.002946021835030666,
  -0.0028347656158007935,
  -0.002635637164875853,
  -0.002351975050679497,
  -0.0019906936886234625,
  -0.0015614264808741214,
  -0.0010751107240511608,
  -0.0005451602366710408,
  0.000013324645205602966,
  0.0005838282329094839,
  0.0011492739480700894,
  0.0016929037837979525,
  0.002197374812550779,
  0.002646640282227606,
  0.003025452509657147,
  0.0033214549405506605,
  0.003523626247903083,
  0.003623931376641696,
  0.0036166802812409664,
  0.0035005277418213763,
  0.003276581892495572,
  0.002949878083192408,
  0.0025279706805685104,
  0.0020218006035990135,
  0.0014450311409153597,
  0.0008138301128590072,
  0.00014625925619099155,
  -0.0005385976117130481,
  -0.001220610167452072,
  -0.001879119641344799,
  -0.002493822777931646,
  -0.0030447821558853214,
  -0.0035137944941211136,
  -0.0038850242897848198,
  -0.004145628882938341,
  -0.0042865046094789,
  -0.004302135038743367,
  -0.004190299457696736,
  -0.0039512104384461875,
  -0.003588014697511986,
  -0.0031090934618440203,
  -0.002528876093438338,
  -0.0018658106211971283,
  -0.0011376557650568729,
  -0.0003609756720458041,
  0.00044135632057797287,
  0.0012404000539930078,
  0.0020124674226900045,
  0.0027399459325651403,
  0.00339770970206145,
  0.00395913114148647,
  0.004412142815655665,
  0.004743256637408868,
  0.004932199348716797,
  0.004977861590155408,
  0.004878375628848195,
  0.004625705078988656,
  0.004235557892087144,
  0.0037126033806714753,
  0.0030678150981331546,
  0.0023286316565277816,
  0.0015022930943260889,
  0.0006269905348593426,
  -0.00028452751519986033,
  -0.0011951144918022152,
  -0.002084745786809651,
  -0.002921714781941119,
  -0.003682941632989709,
  -0.0043429320616334005,
  -0.004881746633086018,
  -0.005281032119784886,
  -0.005527466248355426,
  -0.005611607958995573,
  -0.005529070469653161,
  -0.005280420585698167,
  -0.004871230212104667,
  -0.004311843483785949,
  -0.003617255019904141,
  -0.002806995408387146,
  -0.001904200516241988,
  -0.0009346137436556718,
  0.00007326384484305042,
  0.0010895413466004312,
  0.0020838567624616,
  0.0030261869136698526,
  0.003887806410250618,
  0.004642035479085573,
  0.005265201496975126,
  0.005737340132822568,
  0.006042882587164571,
  0.006171171639336239,
  0.006116541447584764,
  0.005878965495195371,
  0.0054640458716239395,
  0.004882430013000176,
  0.004150134199368106,
  0.003287797769926126,
  0.0023201118208956437,
  0.0012750869519964855,
  0.0001834392372066612,
  -0.0009224300447949606,
  -0.00200966772590708,
  -0.0030456595966301004,
  -0.003998697981978409,
  -0.004840061772203979,
  -0.005543248661367467,
  -0.006086787301382121,
  -0.006452515255779114,
  -0.006629438499088436,
  -0.00660919386615456,
  -0.0063931699385617845,
  -0.005984174309477827,
  -0.005395886998809888,
  -0.004641585305698363,
  -0.0037457066694749426,
  -0.0027321459435380477,
  -0.0016311946621524378,
  -0.0004757890733769631,
  0.0007015358073590059,
  0.0018635837616918095,
  0.0029772562680053473,
  0.004008283130163096,
  0.004924899379522446,
  0.005700771207003042,
  0.006310010075611894,
  0.00673472941142957,
  0.006961867152009146,
  0.006982074120639665,
  0.0067952841174641915,
  0.006406086691794329,
  0.0058238644609743375,
  0.005066764370183187,
  0.004156445272398165,
  0.0031182785298762943,
  0.0019838210651641802,
  0.0007868635333011791,
  -0.0004382512284391282,
  -0.001654662573108785,
  -0.0028250809778444966,
  -0.003915472813396994,
  -0.004893597699855368,
  -0.00572850622095142,
  -0.006394999617443587,
  -0.006873940655369947,
  -0.007150139324090066,
  -0.007214166999684367,
  -0.007063812456680041,
  -0.006703953676898229,
  -0.006144806829645361,
  -0.005401775799837854,
  -0.004496704609217522,
  -0.0034568249943335884,
  -0.002313147058001661,
  -0.0010994805808811012,
  0.00014901880145277155,
  0.00139458596068134,
  0.0025999220082546246,
  0.0037285513267952025,
  0.0047471851510358385,
  0.005625677044657904,
  0.006338138629609906,
  0.006863201595759162,
  0.007184880469764189,
  0.007293158335991768,
  0.007184880469764189,
  0.006863201595759162,
  0.006338138629609906,
  0.005625677044657904,
  0.0047471851510358385,
  0.0037285513267952025,
  0.0025999220082546246,
  0.00139458596068134,
  0.00014901880145277155,
  -0.0010994805808811012,
  -0.002313147058001661,
  -0.0034568249943335884,
  -0.004496704609217522,
  -0.005401775799837854,
  -0.006144806829645361,
  -0.006703953676898229,
  -0.007063812456680041,
  -0.007214166999684367,
  -0.007150139324090066,
  -0.006873940655369947,
  -0.006394999617443587,
  -0.00572850622095142,
  -0.004893597699855368,
  -0.003915472813396994,
  -0.0028250809778444966,
  -0.001654662573108785,
  -0.0004382512284391282,
  0.0007868635333011791,
  0.0019838210651641802,
  0.0031182785298762943,
  0.004156445272398165,
  0.005066764370183187,
  0.0058238644609743375,
  0.006406086691794329,
  0.0067952841174641915,
  0.006982074120639665,
  0.006961867152009146,
  0.00673472941142957,
  0.006310010075611894,
  0.005700771207003042,
  0.004924899379522446,
  0.004008283130163096,
  0.0029772562680053473,
  0.0018635837616918095,
  0.0007015358073590059,
  -0.0004757890733769631,
  -0.0016311946621524378,
  -0.0027321459435380477,
  -0.0037457066694749426,
  -0.004641585305698363,
  -0.005395886998809888,
  -0.005984174309477827,
  -0.0063931699385617845,
  -0.00660919386615456,
  -0.006629438499088436,
  -0.006452515255779114,
  -0.006086787301382121,
  -0.005543248661367467,
  -0.004840061772203979,
  -0.003998697981978409,
  -0.0030456595966301004,
  -0.00200966772590708,
  -0.0009224300447949606,
  0.0001834392372066612,
  0.0012750869519964855,
  0.0023201118208956437,
  0.003287797769926126,
  0.004150134199368106,
  0.004882430013000176,
  0.0054640458716239395,
  0.005878965495195371,
  0.006116541447584764,
  0.006171171639336239,
  0.006042882587164571,
  0.005737340132822568,
  0.005265201496975126,
  0.004642035479085573,
  0.003887806410250618,
  0.0030261869136698526,
  0.0020838567624616,
  0.0010895413466004312,
  0.00007326384484305042,
  -0.0009346137436556718,
  -0.001904200516241988,
  -0.002806995408387146,
  -0.003617255019904141,
  -0.004311843483785949,
  -0.004871230212104667,
  -0.005280420585698167,
  -0.005529070469653161,
  -0.005611607958995573,
  -0.005527466248355426,
  -0.005281032119784886,
  -0.004881746633086018,
  -0.0043429320616334005,
  -0.003682941632989709,
  -0.002921714781941119,
  -0.002084745786809651,
  -0.0011951144918022152,
  -0.00028452751519986033,
  0.0006269905348593426,
  0.0015022930943260889,
  0.0023286316565277816,
  0.0030678150981331546,
  0.0037126033806714753,
  0.004235557892087144,
  0.004625705078988656,
  0.004878375628848195,
  0.004977861590155408,
  0.004932199348716797,
  0.004743256637408868,
  0.004412142815655665,
  0.00395913114148647,
  0.00339770970206145,
  0.0027399459325651403,
  0.0020124674226900045,
  0.0012404000539930078,
  0.00044135632057797287,
  -0.0003609756720458041,
  -0.0011376557650568729,
  -0.0018658106211971283,
  -0.002528876093438338,
  -0.0031090934618440203,
  -0.003588014697511986,
  -0.0039512104384461875,
  -0.004190299457696736,
  -0.004302135038743367,
  -0.0042865046094789,
  -0.004145628882938341,
  -0.0038850242897848198,
  -0.0035137944941211136,
  -0.0030447821558853214,
  -0.002493822777931646,
  -0.001879119641344799,
  -0.001220610167452072,
  -0.0005385976117130481,
  0.00014625925619099155,
  0.0008138301128590072,
  0.0014450311409153597,
  0.0020218006035990135,
  0.0025279706805685104,
  0.002949878083192408,
  0.003276581892495572,
  0.0035005277418213763,
  0.0036166802812409664,
  0.003623931376641696,
  0.003523626247903083,
  0.0033214549405506605,
  0.003025452509657147,
  0.002646640282227606,
  0.002197374812550779,
  0.0016929037837979525,
  0.0011492739480700894,
  0.0005838282329094839,
  0.000013324645205602966,
  -0.0005451602366710408,
  -0.0010751107240511608,
  -0.0015614264808741214,
  -0.0019906936886234625,
  -0.002351975050679497,
  -0.002635637164875853,
  -0.0028347656158007935,
  -0.002946021835030666,
  -0.002967812669403306,
  -0.0029016602769571277,
  -0.00275119766533424,
  -0.0025235232021256528,
  -0.0022269256508041096,
  -0.001871474217074496,
  -0.0014698955205060351,
  -0.0010350050321091527,
  -0.0005801381957648427,
  -0.00011984853913778586,
  0.0003321497111754972,
  0.0007628421450610423,
  0.0011599062296731746,
  0.0015122120172941494,
  0.0018106655894585847,
  0.002047952042401727,
  0.002218172134897853,
  0.002318489360973705,
  0.002348002976173003,
  0.002307082625368846,
  0.002199408762911539,
  0.0020300873589149523,
  0.0018053723642900879,
  0.0015341012376924536,
  0.0012252700954412173,
  0.0008890395632583083,
  0.0005366385305129098,
  0.00017859635878946458,
  -0.00017410200933348457,
  -0.0005111445694923044,
  -0.0008231550506163987,
  -0.001100981470681533,
  -0.0013383369016230506,
  -0.0015286552439903827,
  -0.0016677874249170822,
  -0.001753739148983291,
  -0.0017847221546431504,
  -0.0017622912562730408,
  -0.0016884851142644518,
  -0.0015671681564843496,
  -0.0014036238563394448,
  -0.00120369669859372,
  -0.0009754537736930192,
  -0.0007254473953967967,
  -0.0004629912661549661,
  -0.0001955380245200577,
  0.00006810417062872957,
  0.00032092546341667847,
  0.000554952198749455,
  0.0007644547675825443,
  0.0009437227479152943,
  0.001088768923401314,
  0.0011960987249117257,
  0.0012641643594619694,
  0.001292401281367153,
  0.001281387699582837,
  0.0012328786690603748,
  0.001149658881060617,
  0.0010356927806390746,
  0.0008956934900890466,
  0.0007346064802047301,
  0.000558094428062973,
  0.00037215755851684206,
  0.0001828761748837526,
  -0.000004115686638681422,
  -0.00018340624385128067,
  -0.00034972682601084075,
  -0.0004986787931562572,
  -0.0006265616058274011,
  -0.0007304135574717932,
  -0.0008082668969329513,
  -0.000858749540635288,
  -0.0008814070036755516,
  -0.0008768873413793753,
  -0.0008465893160811388,
  -0.0007926714911828006,
  -0.0007176456653055658,
  -0.00062481242219283,
  -0.0005177542698825884,
  -0.0004003403699552651,
  -0.0002767999466081219,
  -0.000151080343689622,
  -0.000026901205834418963,
  0.00009186585059177863,
  0.00020198435931837415,
  0.0003004104788649088,
  0.00038493252171110254,
  0.00045227377881293173,
  0.0005092223845506028,
  0.0005117760839499976,
  0.0006946480927947145,
  -0.00021272311555558523,
  0.004672801761569144,
  0.0008740924269628361
};






FilterDTMF::FilterDTMF(VerticalDTMFValue freqV, HorizontalDTMFValue freqH)
{

    switch (freqV) {
    case V697:
        this->V = filter_h697_taps;
        this->sizeV = 993;
        this->lastV = 0;
        break;
    case V770:

        break;
    case V852:

        break;
    case V941:

        break;
    default:
        break;
    }

    switch (freqH) {
    case H1209:
        this->H = filter_v1209_taps;
        this->sizeH = 515;
        this->lastH = 0;

        break;
    case H1336:

        break;
    case H1477:

        break;
    case H1633:

        break;

    default:
        break;
    }


    for(unsigned int i = 0; i < sizeH; ++i)
        historyH[i] = 0;
    lastH = 0;
    for(unsigned int i = 0; i < sizeV; ++i)
        historyV[i] = 0;
    lastV = 0;

}

void FilterDTMF::put(double input)
{
    this->historyV[this->lastV++] = input;
    this->lastV = this->lastV % this->sizeV;
    this->historyH[this->lastH++] = input;
    this->lastH = this->lastH % this->sizeH;
}

double FilterDTMF::getH()
{
    double acc = 0;
    unsigned int index = lastH, i;
    for(i = 0; i < sizeH; ++i) {
        index = index != 0 ? index-1 : sizeH-1;
        acc += historyH[index] * H[i];
    };
    return acc;
}


double FilterDTMF::getV()
{
    double acc = 0;
    unsigned int index = lastV, i;
    for(i = 0; i < sizeV; ++i) {
        index = index != 0 ? index-1 : sizeV-1;
        acc += historyV[index] * V[i];
    };
    return acc;
}
